divide-lame-iTunes.pl

(Mac OS X, Terminal から使用するperlスクリプト, sox, lame, MP3::Tag が必要)

【概要】
アナログレコードやカセットテープ、ライブ等を録音した音声ファイルを
分割(端点のフェード), mp3圧縮, iTunes取り込み
するためのスクリプトです。

【使い方】
1.分割元のファイル があるディレクトリに 分割設定.txt を作成
2.分割設定.txt に discog から曲リストをコピー
3.分割設定.txt にアルバム名,年,ジャンル等のメタデータを記入
4.波形エディタで 分割元のファイル の波形を見て、曲の分割点を決定。
  その分割点を 分割設定.txt に記入する
5.divide-lame-iTunes.pl 分割設定.txt を実行

【分割設定ファイルのフォーマット】
以下のタブ区切りデータを複数個書く事ができる。
（Discogのテーブルをコピーしたものに、少し手を加えれば完成する様になっている）

ファイル名	アルバム名	年	ジャンル
開始点位置	トラック番号	アーティスト	曲名
分割点位置	トラック番号	アーティスト	曲名
分割点位置	トラック番号	アーティスト	曲名
終了点位置

このひとかたまりで、ファイル１つ分の分割指示になっている。

"開始点位置", "分割点位置", "終了点位置" は 時分秒.ミリ秒
ff:mm:ss.sss
またはサンプル数
99999s
の形式で指定できる。
終了点位置 の後ろには何も書かずすぐに改行する(タブ記号もダメ)

【分割設定ファイルの動作設定行】
分割設定ファイルに "#" で始まる動作設定行を書く事で、その行以下の動作を変更できる

#fadein 0.3
	フェードイン時間を指定 デフォルトは 0.1
#fadeout 0.3
	フェードアウト時間を指定 デフォルトは 0.1
#fade 0.3
	fadein, fadeout をいっぺんに指定
#normalize 1
	1の時ノーマライズする デフォルトは 0 (しない)
#lameoption -b 256 -h
	lame に渡すオプションを指定する デフォルトは "-b 320 -h"

【分割設定ファイルのコメント】
"##" と "#" 2つで始まる行はコメント行。無視される。

【分割設定ファイルの詳細】
・各項目の前後のスペースはトリムされる
・アルバム名, 年, ジャンルが空白の場合、前のファイルのデータが使われる。
・アーティスト名が空白の場合、前の行のデータが使われる。
　単独アーティストのアルバムなら、1曲目だけ設定を書けばよい
・曲名が空白の場合、連番を使って "Track 9" 等とつけられる。
・トラック番号が空白の場合、連番の数字がつく
・連番はアルバムが変わる毎に（新しいアルバム名が指定される毎に）1からスタートする。

（Discogからリストをコピーした際に便利な機能）
・アーティスト名の後ろの – (Unicode 0x2013) や * はトリムされる。
・アーティスト名が XXXXX, The である場合 The XXXXX に置き換えられる。
・トラック名に英字等、数字以外の文字が含まれる場合は空白として扱われる。

【必要なライブラリ】
sox
lame
MP3::Tag

（インストール方法の例）
sudo port install sox
sudo port install lame
sudo cpan MP3::Tag

【分割設定ファイルのテンプレート】
#fade 0.1
#normalize 1
#lameoption -b 320 -h

##filename	albumname	year	genre
##starttime	number	artist	songname
##finishtime


